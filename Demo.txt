comprehensive solution:
1. First, update the database column if needed
The questions column in m_s_assessment table should store JSON array format (which it already does based on your code).
2. Update panelDashboard.html - Add Import Button
Find the Questions Modal header section and update it:
html<!-- Questions Modal -->
<div id="manageQuestionsModal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
  <div class="bg-white w-full max-w-5xl rounded-lg shadow-lg flex flex-col" style="height: 85vh; max-height: 85vh;" >
    <!-- Header-->
    <div class="flex items-center justify-between p-4 border-b bg-gray-50 rounded-t-lg" style="flex-shrink: 0;" >
      <h2 class="text-2xl font-semibold text-gray-800">Questions</h2>
      <div class="flex gap-2">
        <button id="btnAddQuestion" class="bg-blue-600 text-white px-3 py-2 rounded hover:bg-blue-700">+ Add Question</button>
        <button id="btnImportQuestions" class="bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700">ðŸ“¥ Import from Excel</button>
        <button id="btnDownloadTemplate" class="bg-purple-600 text-white px-3 py-2 rounded hover:bg-purple-700">ðŸ“„ Download Template</button>
        <button id="closeQuestionModal" class="bg-gray-500 text-white px-3 py-2 rounded hover:bg-gray-600">Close</button>
      </div>
    </div>
    <!-- Rest of modal content... -->
3. Add Import Modal to panelDashboard.html
Add this before the closing </body> tag:
html<!-- Import Questions Modal -->
<div id="importQuestionsModal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50">
  <div class="bg-white w-[600px] rounded-lg shadow-lg p-6">
    <h3 class="text-xl font-semibold mb-4 text-gray-800">Import Questions from Excel</h3>
    
    <div class="mb-4">
      <label class="block text-sm font-medium text-gray-700 mb-2">Upload Excel File</label>
      <input type="file" id="excelFileInput" accept=".xlsx,.xls" 
             class="w-full border rounded p-2 cursor-pointer">
      <p class="text-xs text-gray-500 mt-1">Supported formats: .xlsx, .xls</p>
    </div>
    
    <div class="bg-blue-50 border border-blue-200 rounded p-3 mb-4">
      <h4 class="font-semibold text-sm mb-2">ðŸ“‹ Excel Format Requirements:</h4>
      <ul class="text-xs space-y-1 text-gray-700">
        <li>â€¢ <b>Column A:</b> Question Text</li>
        <li>â€¢ <b>Column B:</b> Option A</li>
        <li>â€¢ <b>Column C:</b> Option B</li>
        <li>â€¢ <b>Column D:</b> Option C</li>
        <li>â€¢ <b>Column E:</b> Option D</li>
        <li>â€¢ <b>Column F:</b> Correct Answer (A, B, C, or D)</li>
        <li>â€¢ <b>Column G:</b> Marks (number)</li>
        <li>â€¢ First row should be headers</li>
      </ul>
    </div>
    
    <div id="importPreview" class="hidden mb-4">
      <h4 class="font-semibold mb-2">Preview (First 3 Questions):</h4>
      <div id="previewContent" class="max-h-48 overflow-y-auto border rounded p-2 text-xs"></div>
    </div>
    
    <div class="flex justify-end gap-2">
      <button type="button" id="cancelImport" class="bg-gray-300 px-4 py-2 rounded">Cancel</button>
      <button type="button" id="confirmImport" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700" disabled>Import Questions</button>
    </div>
  </div>
</div>
4. Update panelDashboard.js - Add Import Functionality
Add this code to handle imports:
javascript// Import Questions - Button Click
$("#btnImportQuestions").click(function() {
    $("#importQuestionsModal").removeClass("hidden");
    $("#excelFileInput").val("");
    $("#importPreview").addClass("hidden");
    $("#confirmImport").prop("disabled", true);
});

$("#cancelImport").click(function() {
    $("#importQuestionsModal").addClass("hidden");
});

// Download Template
$("#btnDownloadTemplate").click(function() {
    downloadExcelTemplate();
});

// File Upload Handler
let parsedQuestions = [];

$("#excelFileInput").change(function(e) {
    let file = e.target.files[0];
    if (!file) return;
    
    let reader = new FileReader();
    reader.onload = function(e) {
        try {
            let data = new Uint8Array(e.target.result);
            let workbook = XLSX.read(data, { type: 'array' });
            let firstSheet = workbook.Sheets[workbook.SheetNames[0]];
            let jsonData = XLSX.utils.sheet_to_json(firstSheet);
            
            parsedQuestions = parseExcelQuestions(jsonData);
            
            if (parsedQuestions.length > 0) {
                showImportPreview(parsedQuestions);
                $("#confirmImport").prop("disabled", false);
                notyf.success(`Found ${parsedQuestions.length} questions`);
            } else {
                notyf.error("No valid questions found in file");
            }
        } catch (error) {
            console.error("Excel parse error:", error);
            notyf.error("Error reading Excel file");
        }
    };
    reader.readAsArrayBuffer(file);
});

// Parse Excel Data
function parseExcelQuestions(jsonData) {
    let questions = [];
    
    jsonData.forEach((row, index) => {
        // Skip if row is empty
        if (!row.Question || !row.OptionA) return;
        
        let question = {
            question: String(row.Question || row.question || "").trim(),
            optionA: String(row.OptionA || row.optionA || row["Option A"] || "").trim(),
            optionB: String(row.OptionB || row.optionB || row["Option B"] || "").trim(),
            optionC: String(row.OptionC || row.optionC || row["Option C"] || "").trim(),
            optionD: String(row.OptionD || row.optionD || row["Option D"] || "").trim(),
            correctAnswer: String(row.CorrectAnswer || row.correctAnswer || row["Correct Answer"] || "").trim().toUpperCase(),
            marks: parseInt(row.Marks || row.marks || 1)
        };
        
        // Validate
        if (question.question && question.optionA && question.optionB && 
            ["A", "B", "C", "D"].includes(question.correctAnswer)) {
            questions.push(question);
        } else {
            console.warn(`Skipped invalid row ${index + 2}`);
        }
    });
    
    return questions;
}

// Show Preview
function showImportPreview(questions) {
    let preview = questions.slice(0, 3);
    let html = "";
    
    preview.forEach((q, i) => {
        html += `<div class="mb-2 p-2 bg-gray-50 rounded">
            <b>Q${i+1}:</b> ${q.question}<br>
            <span class="text-xs">A) ${q.optionA} | B) ${q.optionB}<br>
            C) ${q.optionC} | D) ${q.optionD}<br>
            <span class="text-green-600">Answer: ${q.correctAnswer}</span> | Marks: ${q.marks}</span>
        </div>`;
    });
    
    if (questions.length > 3) {
        html += `<p class="text-center text-gray-500 text-xs mt-2">...and ${questions.length - 3} more questions</p>`;
    }
    
    $("#previewContent").html(html);
    $("#importPreview").removeClass("hidden");
}

// Confirm Import
$("#confirmImport").click(function() {
    if (parsedQuestions.length === 0) {
        notyf.error("No questions to import");
        return;
    }
    
    let assessmentId = $("#mq_assessment_id").val();
    
    Swal.fire({
        title: "Import Questions?",
        text: `This will add ${parsedQuestions.length} questions to the assessment.`,
        icon: "question",
        showCancelButton: true,
        confirmButtonText: "Yes, Import",
        confirmButtonColor: "#16a34a"
    }).then((result) => {
        if (result.isConfirmed) {
            importQuestionsToDatabase(assessmentId, parsedQuestions);
        }
    });
});

// Import to Database
function importQuestionsToDatabase(assessmentId, questions) {
    // Show loading
    Swal.fire({
        title: 'Importing...',
        html: 'Please wait while questions are being imported',
        allowOutsideClick: false,
        didOpen: () => {
            Swal.showLoading();
        }
    });
    
    // Get existing questions first
    ajaxGet("getQuestionsByAssessment", { assessment_id: assessmentId }, function(res) {
        let existingQuestions = (res.status == "success" && res.questions) ? res.questions : [];
        let nextId = existingQuestions.length + 1;
        
        // Add question IDs
        let newQuestions = questions.map((q, index) => ({
            questionId: nextId + index,
            question: q.question,
            optionA: q.optionA,
            optionB: q.optionB,
            optionC: q.optionC,
            optionD: q.optionD,
            correctAnswer: q.correctAnswer,
            marks: q.marks
        }));
        
        // Merge with existing
        let allQuestions = existingQuestions.concat(newQuestions);
        
        // Calculate totals
        let totalMarks = allQuestions.reduce((sum, q) => sum + (q.marks || 0), 0);
        
        // Update database
        ajaxPost("bulkImportQuestions", {
            assessment_id: assessmentId,
            questions: JSON.stringify(allQuestions),
            total_questions: allQuestions.length,
            total_marks: totalMarks
        }, function(response) {
            Swal.close();
            
            if (response.status == "success") {
                notyf.success(`${newQuestions.length} questions imported successfully!`);
                $("#importQuestionsModal").addClass("hidden");
                
                // Reload questions
                ajaxGet("getQuestionsByAssessment", { assessment_id: assessmentId }, function(res2) {
                    if (res2.status == "success") {
                        AssessmentUtils.renderQuestions(res2.questions, assessmentId);
                    }
                });
            } else {
                notyf.error(response.message || "Import failed");
            }
        });
    });
}

// Download Excel Template
function downloadExcelTemplate() {
    let template = [
        {
            "Question": "What is DevOps?",
            "OptionA": "Development and Operations",
            "OptionB": "Department and Operations",
            "OptionC": "Development and Occupation",
            "OptionD": "Data and Operations",
            "CorrectAnswer": "A",
            "Marks": 1
        },
        {
            "Question": "Which tool is used for version control?",
            "OptionA": "Docker",
            "OptionB": "Git",
            "OptionC": "Jenkins",
            "OptionD": "Kubernetes",
            "CorrectAnswer": "B",
            "Marks": 1
        }
    ];
    
    let ws = XLSX.utils.json_to_sheet(template);
    let wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "Questions");
    
    XLSX.writeFile(wb, "Questions_Template.xlsx");
    notyf.success("Template downloaded!");
}
5. Create Backend Handler - MainServlet.java
Add this case in the doPost method:
javacase "bulkImportQuestions": {
    logger.info("Received action: bulkImportQuestions");
    JsonObject res = new JsonObject();
    try {
        int assessmentId = Integer.parseInt(request.getParameter("assessment_id"));
        String questionsJson = request.getParameter("questions");
        int totalQuestions = Integer.parseInt(request.getParameter("total_questions"));
        int totalMarks = Integer.parseInt(request.getParameter("total_marks"));
        
        // Update assessment with new questions
        Connection conn = DBConnector.getConnection();
        String sql = "UPDATE m_s_assessment SET questions=?, total_questions=?, total_marks=? WHERE assessment_id=?";
        PreparedStatement pstmt = conn.prepareStatement(sql);
        pstmt.setString(1, questionsJson);
        pstmt.setInt(2, totalQuestions);
        pstmt.setInt(3, totalMarks);
        pstmt.setInt(4, assessmentId);
        
        int rows = pstmt.executeUpdate();
        
        if (rows > 0) {
            res.addProperty("status", "success");
            res.addProperty("message", "Questions imported successfully");
            logger.info("Bulk import successful for assessment " + assessmentId);
        } else {
            res.addProperty("status", "error");
            res.addProperty("message", "Failed to import questions");
        }
        
        pstmt.close();
        conn.close();
        
    } catch (Exception e) {
        logger.error("Error in bulkImportQuestions", e);
        res.addProperty("status", "error");
        res.addProperty("message", "Server error: " + e.getMessage());
    }
    response.getWriter().write(res.toString());
    break;
}
6. Add SheetJS Library Reference
In panelDashboard.html, add this in the <head> section:
html<!-- SheetJS for Excel Processing -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
Usage Instructions:

Click "Manage Questions" on any assessment
Click "Download Template" to get sample Excel format
Fill in your questions following the template structure
Click "Import from Excel" and select your file
Preview will show first 3 questions
Click "Import Questions" to add them to the database

The system will:

âœ… Validate each question
âœ… Skip invalid rows
âœ… Auto-assign question IDs
âœ… Update total marks/questions
âœ… Merge with existing questions
âœ… Store in JSON format matching your structure

This solution provides a complete Excel import feature with validation, preview, and proper database storage! ðŸŽ¯RetryClaude can make mistakes. Please double-check responses.
